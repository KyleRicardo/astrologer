---
import ProjectDetail from '@/components/ProjectDetail.astro'
import { getProjectPaths } from '@/utils/getPosts'
import { languages, defaultLang } from '@/i18n/ui'
import type { Lang } from '@/i18n/utils'

export async function getStaticPaths() {
  const langs = Object.keys(languages).filter((l) =>
    l !== defaultLang
  ) as Lang[]
  const paths = await Promise.all(
    langs.map(async (lang) => {
      const projectPaths = await getProjectPaths(lang)
      return projectPaths.map((path) => ({
        params: { ...path.params, lang },
        props: path.props,
      }))
    }),
  )
  return paths.flat()
}

const { lang } = Astro.params as { lang: Lang }
const project = Astro.props
---

<ProjectDetail project={project} lang={lang} />
